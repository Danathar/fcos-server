name: server
description: Custom Fedora CoreOS Server

base-image: quay.io/fedora/fedora-coreos
image-version: stable

modules:
  - type: files
    files:
      /etc/yum.repos.d/tailscale.repo: |
        [tailscale]
        name=Tailscale stable
        baseurl=https://pkgs.tailscale.com/stable/fedora/$releasever/$basearch
        enabled=1
        gpgcheck=1
        gpgkey=https://pkgs.tailscale.com/stable/fedora/repo.gpg

  - type: dnf
    install:
      packages:
        - vim
        - btop
        - zsh
        - atuin
        - podlet
        - util-linux-script
        - rpmconf
        - qemu-guest-agent
        - cockpit-podman
        - cockpit-ostree
        - cockpit-selinux
        - cockpit-storaged
        - tailscale
    remove:
      packages:
        - nano

  - type: dnf
    repos:
      copr:
        - atim/starship
    install:
      packages:
        - starship

  - type: systemd
    system:
      disabled:
        - zincati.service

  - type: signing

